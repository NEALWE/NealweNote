(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24fb4131"],{"08ef":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("el-form",{ref:"postForm",staticClass:"form-container",attrs:{model:t.postForm,rules:t.rules}},[n("div",{staticStyle:{"margin-left":"5%","margin-right":"5%"}},[n("el-row",[n("el-form-item",{staticStyle:{"margin-bottom":"20px"},attrs:{prop:"title"}},[n("MDinput",{attrs:{maxlength:100,name:"name",required:""},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}},[t._v("\n            "+t._s("标签为："+this.label)+"\n          ")])],1),t._v(" "),n("div",{staticStyle:{"margin-bottom":"20px"}},[n("froala",{attrs:{id:"edit",config:this.froalaConfig},model:{value:t.froalaContent,callback:function(e){t.froalaContent=e},expression:"froalaContent"}})],1),t._v(" "),n("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-bottom":"20px"},attrs:{type:"success"},on:{click:function(e){return t.submitForm(!0)}}},[t._v("\n          Publish\n        ")])],1)],1)]),t._v(" "),n("el-tooltip",{attrs:{placement:"top",content:"返回顶部"}},[n("back-to-top",{attrs:{"custom-style":t.myBackToTopStyle,"visibility-height":0,"back-position":50,"transition-name":"fade"}})],1)],1)},i=[],a=(n("7f7f"),n("f419")),l=n.n(a),s=n("8256"),r=n("70a2"),c=n("1aba"),u=n("b804"),d=n("61f7"),h=n("2423"),p=n("828d"),f=n("62f2"),m=n("4482"),g=n("b1fc"),b=n.n(g),_=n("2c65"),C=n("0625");b.a.DefineIcon("alert",{NAME:"info",SVG_KEY:"help"}),b.a.RegisterCommand("alert",{title:"Hello",focus:!1,undo:!1,refreshAfterCallback:!1,callback:function(){alert("Hello!")}});var v={status:"draft",title:"",content:"",content_short:"",source_uri:"",image_uri:"",display_time:void 0,id:void 0,platforms:["a-platform"],comment_disabled:!1,importance:0},y={name:"EditArticle",components:{Tinymce:s["a"],MDinput:c["a"],Upload:r["a"],Sticky:u["a"],Warning:f["a"],CommentDropdown:m["a"],PlatformDropdown:m["b"],SourceUrlDropdown:m["c"],ElDragSelect:_["a"],tree:l.a,BackToTop:C["a"]},data:function(){var t=this,e=function(e,n,o){""===n?(t.$message({message:e.field+"为必传项",type:"error"}),o(new Error(e.field+"为必传项"))):o()},n=function(e,n,o){n?Object(d["d"])(n)?o():(t.$message({message:"外链url填写不正确",type:"error"}),o(new Error("外链url填写不正确"))):o()};return{leave:!1,editCheckId:null,myBackToTopStyle:{right:"1.5%",bottom:"50px",width:"40px",height:"40px","border-radius":"4px","line-height":"45px",background:"#e7eaf1"},timer:null,article:"",fullscreenLoading:!1,value:["Apple","Banana","Orange"],options:[{value:"Apple",label:"Apple"},{value:"Banana",label:"Banana"},{value:"Orange",label:"Orange"},{value:"Pear",label:"Pear"},{value:"Strawberry",label:"Strawberry"}],postForm:Object.assign({},v),loading:!1,userListOptions:[],rules:{image_uri:[{validator:e}],source_uri:[{validator:n,trigger:"blur"}]},tempRoute:{},froalaConfig:{toolbarButtons:{moreText:{buttons:["bold","italic","underline","fontSize","textColor","backgroundColor","strikeThrough","subscript","superscript","fontFamily","inlineClass","inlineStyle","clearFormatting"],buttonsVisible:6},moreParagraph:{buttons:["formatOL","formatUL","alignJustify","paragraphStyle","alignLeft","alignCenter","alignRight","lineHeight","outdent","indent","quote"],buttonsVisible:6},moreRich:{buttons:["insertLink","insertImage","insertVideo","insertTable","emoticons","fontAwesome","specialCharacters","embedly","insertFile","insertHR"],buttonsVisible:2},moreMisc:{buttons:["undo","redo","fullscreen","print","getPDF","spellChecker","selectAll","html","help"],buttonsVisible:3}},placeholderText:"Start typing something...",heightMin:"900",language:"zh_cn",imageUploadURL:"/api/note/upload/",fileUploadURL:"/api/note/upload/",quickInsertEnabled:!1,toolbarVisibleWithoutSelection:!0,disableRightClick:!0,colorsHEXInput:!1,toolbarSticky:!0,zIndex:2,events:{"froalaEditor.initialized":function(){console.log("initialized")}}},title:"",label:"",froalaContent:"Please Wait For Loading...",froalaContent_length:0}},watch:{froalaContent:{handler:function(t,e){console.log("this.froalaContent_length: "+this.froalaContent_length),this.froalaContent_length=this.froalaContent_length+1,this.froalaContent_length>=3&&(console.log("auto submitForm"),this.froalaContent_length=0,this.submitForm(!1))},deep:!0}},computed:{contentShortLength:function(){return this.postForm.content_short.length},displayTime:{get:function(){return+new Date(this.postForm.display_time)},set:function(t){this.postForm.display_time=new Date(t)}}},created:function(){this.editCheckId=this.$route.params&&this.$route.params.id,this.tempRoute=Object.assign({},this.$route),this.get_title(),this.get_label(),this.get_note_content()},methods:{downloadPDF:function(){var t=this;this.fullscreenLoading=!0,setTimeout((function(){t.fullscreenLoading=!1,t.$nextTick((function(){window.print()}))}),3e3)},get_title:function(){var t=this;this.url="/api/note/get_title/",this.$axios.post(this.url,{note_id:this.editCheckId}).then((function(e){t.title=e.data}))},get_label:function(){var t=this;this.url="/api/note/get_label/",this.$axios.post(this.url,{note_id:this.editCheckId}).then((function(e){t.label=e.data,t.setTagsViewTitle(t.label)}))},get_note_content:function(){var t=this;this.url="/api/note/get_note_content_by_id/",this.$axios.post(this.url,{note_id:this.editCheckId}).then((function(e){""===e.data?t.froalaContent="-":t.froalaContent=e.data}))},nodeClick:function(t){console.log(JSON.parse(JSON.stringify(t)))},contextmenuClick:function(t){console.log(t),console.log("触发了自定义的contextmenuClick事件")},expandClick:function(t){console.log(JSON.parse(JSON.stringify(t))),t.isExpand&&t.hasOwnProperty("children")&&(t.loadNode=1,setTimeout((function(){t.loadNode=2,t.isFolder=!t.isFolder,t.children.push({id:+new Date,name:"动态加载节点1",path:"",clickNode:!1,isFolder:!1,isExpand:!1,loadNode:0,children:[{id:+new Date+1,name:"动态加载末节点",path:"",clickNode:!1,isExpand:!1,isFolder:!1,loadNode:0}]})}),1e3))},fetchData:function(t){var e=this;Object(h["a"])(t).then((function(t){e.postForm=t.data,e.postForm.title+="   Article Id:".concat(e.postForm.id),e.postForm.content_short+="   Article Id:".concat(e.postForm.id),e.setTagsViewTitle(),e.setPageTitle()})).catch((function(t){console.log(t)}))},setTagsViewTitle:function(t){t.length>10&&(t=t.substring(0,9)+".."),console.log("setTagsViewTitle:"+t);var e=Object.assign({},this.tempRoute,{title:t});this.$store.dispatch("tagsView/updateVisitedView",e)},setPageTitle:function(){var t="Edit Article";document.title="".concat(t," - ").concat(this.$route.id)},submitForm:function(t){var e=this;this.url="/api/note/saveNodeContent/",""!==this.froalaContent?this.$axios.post(this.url,{note_tree_label:this.label,note_title:this.title,note_content:this.froalaContent,note_id:this.editCheckId}).then((function(n){t&&e.$notify({title:"成功",message:"发布文章成功",type:"success",duration:2e3})})).catch((function(t){e.$notify({title:"发生错误",message:t.code,type:"error",duration:2e3})})):this.$notify({title:"失败",message:"文章内容不得为空，请刷新重试！",type:"warning",duration:2e3})},draftForm:function(){0!==this.postForm.content.length&&0!==this.postForm.title.length?(this.$message({message:"保存成功",type:"success",showClose:!0,duration:1e3}),this.postForm.status="draft"):this.$message({message:"请填写必要的标题和内容",type:"warning"})},getRemoteUserList:function(t){var e=this;Object(p["a"])(t).then((function(t){t.data.items&&(e.userListOptions=t.data.items.map((function(t){return t.name})))}))},autoUpdate:function(){var t=this;this.timer=setInterval((function(){t.url="/api/note/saveNodeContent/",""!==t.froalaContent?t.$axios.post(t.url,{note_tree_label:t.label,note_title:t.title,note_content:t.froalaContent,note_id:t.editCheckId}).then((function(t){})):t.$notify({title:"自动更新失败",message:"文章内容不得为空，请刷新重试！",type:"warning",duration:2e3})}),1e3)}},mounted:function(){console.log("mount")}},k=y,w=(n("8be2"),n("8c8e"),n("2877")),x=Object(w["a"])(k,o,i,!1,null,"8df3a996",null);e["default"]=x.exports},"14b4":function(t,e,n){},"8be2":function(t,e,n){"use strict";var o=n("ea9a"),i=n.n(o);i.a},"8c8e":function(t,e,n){"use strict";var o=n("14b4"),i=n.n(o);i.a},ea9a:function(t,e,n){}}]);